<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <script src="https://cdn.jsdelivr.net/npm/vega@4.2.0/build/vega.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@3.0.0-rc5/build/vega-lite.js"></script>
  <style>
    body {
      color: rgb(102, 102, 102);
    }

    a {
      text-decoration-line: none;
    }

    a:link {
      color: rgb(255, 174, 0);
    }

    /* mouse over link */
    a:hover {
      color: rgb(189, 129, 0);
    }

    /* selected link */
    a:active {
      color: rgb(104, 71, 0);
    }
  </style>
  <title>Pokemon Go Forecast - Bangkok area</title>
</head>

<body>
  <div id="date"></div>
  <h1>Developed by <a href="http://github.com/chanwutk">Chanwut Kittivorawong</a>, Porschazz, and muinaruk</h1>
  <div id="vis"></div>
  <script>
  const emojiMap = {
    Windy: 'üå™',
    'Partly Cloudy': '‚õÖÔ∏è',
    Sunny: '‚òÄÔ∏è',
    Clear: 'üåô',
    Cloudy: '‚òÅÔ∏è',
    Fog: 'üå´',
    Rain: '‚òîÔ∏è',
    Snow: '‚õÑÔ∏è',
  };
  const timeMap = {};
  for (let i = 0; i < 24; i++) {
    timeMap['' + i] = (i % 12) + (i >= 12 ? 'PM' : 'AM');
  }
  timeMap['0'] = '12AM';
  timeMap['12'] = '12PM';
  const spec = (data) => ({
    $schema: 'https://vega.github.io/schema/vega-lite/v2.json',
    config: {
      view: { stroke: '' },
    },
    width: 1500,
    height: 500,
    data: { values: data },
    transform: [
      { calculate: 'datum.weather !== null', as: 'valid' },
      { filter: { field: 'valid', equal: true } },
      { calculate: JSON.stringify(emojiMap) + '[datum.weather]', as: 'emoji' },
      { calculate: JSON.stringify(timeMap) + '[datum.time]', as: 'time' },
    ],
    encoding: {
      x: {
        field: 'time',
        type: 'nominal',
        axis: {
          // title: 'Time',
          // titleFontSize: 50,
          // titlePadding: 25,
          title: '',
          labelAngle: 0,
          labelFontSize: 30,
          labelPadding: 15,
          labelBaseline: 'bottom',
          ticks: false,
          domain: false,
          orient: 'top',
        },
        sort: { field: 'order', op: 'min', order: 'ascending' },
      },
      y: {
        field: 'city',
        type: 'nominal',
        axis: {
          // title: 'City',
          // titleFontSize: 50,
          // titlePadding: 25,
          title: '',
          labelFontSize: 20,
          labelPadding: 15,
          ticks: false,
          domain: false,
        },
      },
    },
    layer: [
      {
        mark: { type: 'text', baseline: 'middle' },
        encoding: {
          text: { field: 'emoji', type: 'nominal' },
          size: { value: 50 },
        },
      },
      {
        mark: { type: 'text', baseline: 'middle', dy: 25 },
        encoding: {
          text: { field: 'types', type: 'nominal' },
          size: { value: 8 },
        },
      },
    ],
  });
  const render = () => {
    let xhttp = new XMLHttpRequest();
    let jsonText;
    xhttp.open('GET', 'https://27ff5ae0.ngrok.io/weather.php', false);
    xhttp.onreadystatechange = () => {
      if (xhttp.readyState === 4)
        if (xhttp.status === 200 || xhttp.status === 0) jsonText = xhttp.responseText;
    };
    xhttp.send(null);

    var data = JSON.parse(jsonText);
    const parseSpec = vega.parse(vl.compile(spec(data)).spec);

    new vega.View(parseSpec)
      .renderer('svg')
      .initialize('#vis')
      .run();
  };
  render();
  setInterval(render, 120000);
  const d = new Date();
  const date = document.getElementById('date');
  date.innerHTML = d.toString();

  </script>
  <p>‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÉ‡∏ô‡πÄ‡∏Å‡∏° ‡πÇ‡∏õ‡πÄ‡∏Å‡∏°‡∏≠‡∏ô ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πà‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏° ‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏≠‡∏á‡∏´‡∏•‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏õ‡∏£‡∏µ‡∏î‡∏µ‡∏Ø
    ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏°‡∏∏‡πà‡∏á‡∏´‡∏ß‡∏±‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤ ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÉ‡∏î‡πÜ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô</p>
  
  <p>‡πÇ‡∏î‡∏¢‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏à‡∏∞‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô 2 ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</p>
  
  <p>‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà 1 6.00-18.00 ‡∏ô.</p>
  <p>‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà 2 17.00-5.00 ‡∏ô. ‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</p>
  
  <p>*‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ ‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 14.00-18.00 ‡∏ô. ‡∏≠‡∏≤‡∏à‡∏Ñ‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
</body>

</html>